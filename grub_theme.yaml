- name: Reset Virtual Machine with Ansible

  hosts: dev_host

  roles:
    - reset_vm

- name: Run initial system Setup

  hosts: dev_client_fedora
  vars:
    - download_tmp_dir: "/Downloads/tmp/"

  tasks:
    - name: Clone Grub2-Themes from github
      ansible.builtin.git:
        repo: "https://github.com/vinceliuice/grub2-themes.git"
        dest: "{{ ansible_env.HOME }}{{ download_tmp_dir }}grub2-themes/"
        single_branch: true
        version: master
        depth: 1

    - name: Install Grub2-Themes
      ansible.builtin.command: "./install.sh --theme tela --icon color --screen 1080p --boot"
      args:
        chdir: "{{ ansible_env.HOME }}{{ download_tmp_dir }}grub2-themes/"
      register: install_result
      changed_when: install_result.rc == 0
      become: true

    - name: Remove downloaded repositories
      ansible.builtin.file:
        path: "{{ ansible_env.HOME }}{{ download_tmp_dir }}"
        state: absent
