---

# - name: Reset Virtual Machine with Ansible

#   hosts: dev_host

#   roles:
#     - reset_vm

- name: Debug

  hosts: dev_client_fedora
  vars_files:
    - gnome_settings.yaml

  tasks:

    - name: Just ping it
      ansible.builtin.ping:

    - name: Get UI users home dir
      ansible.builtin.user:
        name: mainws
        state: present
      register: ui_user

    - name: Show Ui user var
      ansible.builtin.debug:
        msg: "{{ ui_user.home }}"

    - name: Install pip
      ansible.builtin.package:
        name: pip
        state: present
      become: true

    - name: Install pip psutil package
      ansible.builtin.pip:
        name: psutil
        state: present
      become: true
      become_user: mainws

    # - name: Set top bar button layout
    #   ansible.builtin.command: dconf write /org/gnome/desktop/wm/preferences/button-layout "'appmenu:minimize,maximize,close'"
    #   # gsettings set org.gnome.desktop.wm.preferences button-layout 'close,minimize,maximize:appmenu'
    #   register: command_result
    #   changed_when: command_result.rc == 0
    #   become: true
    #   become_user: mainws

    - name: Clone Tiling-Assistant from github
      ansible.builtin.git:
        repo: "https://github.com/Leleat/Tiling-Assistant.git"
        dest: "{{ ui_user.home }}{{ download_tmp_dir }}Tiling-Assistant/"
        single_branch: true
        version: v43
        depth: 1
      become: true
      become_user: mainws
